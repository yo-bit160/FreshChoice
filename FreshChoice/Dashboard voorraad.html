<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="dashboard voorraad.css">
  </head>
  <body>
    <div class="hoofd">

      <!-- 1. Algemene voorraadstatus -->
      <div class="een">
        <div class="een-header">Algemene Voorraadstatus</div>
        <div class="een-body">
            <p><b>Totale voorraad:</b> <?php echo $totalVoorraad; ?> producten</p>
        </div>
      </div>  
      
      <!-- 2. Voorraad per categorie -->
      <div class="twee">
        <div class="twee-header">Voorraad per categorie</div>
        <div class="twee-body">
          <?php while($row = $perCategorie->fetch_assoc()): ?>
            <p><b><?= $row['naam'] ?>:</b> <?= $row['totaal'] ?></p>
          <?php endwhile; ?>
        </div>
      </div>
      
      <!-- 3. Urgente tekorten -->
      <div class="drie">
        <div class="drie-header">Urgente tekorten</div>
        <div class="drie-body">
          <?php while($row = $tekorten->fetch_assoc()): ?>
            <p>⚠ <b><?= $row['productnaam'] ?></b> — <?= $row['melding'] ?></p>
          <?php endwhile; ?>
        </div>
      </div>

      <!-- 4. Leveranciers -->
      <div class="vier">
        <div class="vier-header">Leveranciers en Bestellingen</div>
        <div class="vier-body">
          <?php while($row = $leveranciers->fetch_assoc()): ?>
            <p><b><?= $row['naam'] ?></b> — Status: <?= $row['status'] ?></p>
          <?php endwhile; ?>
        </div>
      </div>  

      <!-- 5. Klantgegevens -->
      <div class="vijf">
        <div class="vijf-header">Klantgegevens</div>
        <div class="vijf-body">
          <?php while($row = $klanten->fetch_assoc()): ?>
            <p><b><?= $row['naam'] ?>:</b> <?= $row['activiteiten'] ?></p>
          <?php endwhile; ?>
        </div>
      </div>

      <!-- 6. Verkoopstatistieken -->
      <div class="zes">
        <div class="zes-header">Verkoopstatistieken</div>
        <div class="zes-body">
          <?php while($row = $verkoop->fetch_assoc()): ?>
            <p>
              <b><?= $row['productnaam'] ?></b> — 
              Verkocht: <?= $row['aantal_verkocht'] ?> stuks — 
              Omzet: €<?= $row['omzet'] ?>
            </p>
          <?php endwhile; ?>
        </div>
      </div>

    </div>
   
<script>
async function laadData() {
    // Totale voorraad
    fetch("api/voorraad.php")
        .then(r => r.json())
        .then(data => {
            document.querySelector(".een-body").innerHTML = `
                <p>Totale producten in voorraad: <b>${data.length}</b></p>
            `;
        });

    // Tekorten
    fetch("api/tekorten.php")
        .then(r => r.json())
        .then(data => {
            document.querySelector(".drie-body").innerHTML = data.map(melding => `
                <p>${melding.melding} (${melding.datum})</p>
            `).join("");
        });

    // Verkoopstatistieken
    fetch("api/verkoop.php")
        .then(r => r.json())
        .then(data => {
            document.querySelector(".zes-body").innerHTML = `
                <h3>Omzet: € ${data.reduce((a,b)=>a+parseFloat(b.omzet),0)}</h3>
            `;
        });
}

laadData();
</script>

   
  </body>
</html>